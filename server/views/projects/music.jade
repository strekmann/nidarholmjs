extends ../layouts/main.jade

block content
  section#music

  script#template(type="text/ractive")
    .row
      .columns
        h1 Notearkivet
        if is_member
          form(on-submit="ignoreSubmit")
            .row
              .columns
                label(for="filter") Filter
                input#filter(type="text" name="q" value="{{query}}")
          | {{^query}}
          ul
            | {{#pieces}}
            li
              a(href="/music/{{._id}}")
                | {{{pretty_piece(.)}}}
            | {{/pieces}}
          | {{/query}}
          | {{#filtered.length}}
          ul
            | {{#filtered}}
            li
              a(href="/music/{{._id}}")
                | {{{pretty_piece(.)}}}
            | {{/filtered}}
          | {{/filtered.length}}
          | {{^filtered.length}}
          p Ingen treff
          | {{/filtered.length}}

block javascript
  script
    | require('s7n').projects.musicView(
    != JSON.stringify(pieces)
    | );
