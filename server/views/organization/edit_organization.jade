extends ../layouts/main

block content
  section#contacts
    .row
      .columns
        h1 Endre organisasjonsopplysninger

        form(method="post")
          .row
            .columns
              label(for"name") Organisasjonens navn
              input#name(type="text" name="name" value=organization.name required)
          .row
            .columns
              label(for"webdomain") Domene
              input#webdomain(type="text" name="webdomain" value=organization.webdomain required)
          .row
            .columns
              label(for"email") Epost
              input#email(type="text" name="email" value=organization.email required)
          .row
            .columns
              label(for="organization_number") Organisasjonsnummer
              input#organization_number(type="text" name="organization_number" value=organization.organization_number)

          .row
            .columns
              label(for="visitor_address") Besøksadresse
              input#visitor_address(type="text" name="visitor_address" value=organization.visitor_address)

          .row
            .columns
              label(for="mail_address") Postadresse
              input#mail_address(type="text" name="mail_address" value=organization.mail_address)

          .row
            .columns.small-3
              label(for="postcode") Postnummer
              input#postcode(type="text" name="postcode" value=organization.postcode)
            .columns.small-9
              label(for="city") Poststed
              input#city(name="city" type="text" value=organization.city)

          .row
            .columns
              label(for="public_bank_account") Kontonummer
              input#public_bank_account(type="text" name="public_bank_account" value=organization.public_bank_account)

          .row
            .columns
              label(for="map_url") Kart-URL
              input#map_url(type="text" name="map_url" value=organization.map_url)

          .row
            .columns
              label(for="facebook") Facebook-brukernavn (unik ID)
              .row.collapse
                .small-5.medium-3.large-2.columns
                  span.prefix http://facebook.com/
                .small-7.medium-9.large-10.columns
                  input#facebook(type="text" name="facebook" value=organization.social_media.facebook)

          .row
            .columns
              label(for="twitter") Twitter-brukernavn (unik ID)
              .row.collapse
                .small-5.medium-3.large-2.columns
                  span.prefix http://twitter.com/
                .small-7.medium-9.large-10.columns
                  input#twitter(type="text" name="twitter" value=organization.social_media.twitter)

          .row
            .columns
              label(for="contact_text") Karttekst
              textarea#contact_text(name="contact_text")= organization.contact_text

          each locale in locales
            .row
              .columns
                label(for="description_"+locale)
                  | Beskrivelse på språk
                  | &nbsp;
                  = locale
                textarea(id="description_"+locale name="description["+locale+"]")= organization.description[locale]

          .row
            .columns
              label(for="tracking_code") Sproringskode for Piwik eller andre sporingstjenester
              textarea#tracking_code(name="tracking_code")= organization.tracking_code

          .row
            .columns
              button.small(type="submit") Lagre

          #admin-change

  script#admin-change-template(type="text/ractive")
    hr
    .row
      .columns.medium-6
        h2 Administratorgruppe

        form()
          label(for="admin_group")
          select#admin_group(value="{{admin_group}}" on-blur="setAdminGroup")
            | {{#user_groups}}
            option(value="{{._id}}") {{.name}}
            | {{/user_groups}}
        a.button.tiny(href="/groups/{{admin_group}}") Rediger gruppemedlemmer

      .columns.medium-6
        h2 Noteadministratorgruppe

        form()
          label(for="musicscoreadmin_group")
          select#musicscoreadmin_group(value="{{musicscoreadmin_group}}" on-blur="setMusicscoreadminGroup")
            option
            | {{#groups}}
            option(value="{{._id}}") {{.name}}
            | {{/groups}}
        a.button.tiny(href="/groups/{{musicscoreadmin_group}}") Rediger gruppemedlemmer

block javascript
  script.
    require('s7n').organization.editOrganizationView();
  script
    | require('s7n').organization.setMusicscoreAdminView(
    != JSON.stringify(groups)
    | ,
    != JSON.stringify(active_user.groups)
    | ,
    != JSON.stringify(organization.administration_group._id)
    | ,
    if (!organization.musicscoreadmin_group)
      != JSON.stringify("")
    else
      != JSON.stringify(organization.musicscoreadmin_group)
    | );
